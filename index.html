<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Slots Extreme - Multiplayer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root {
            --primary: #e63946;
            --secondary: #457b9d;
            --dark: #1d3557;
            --light: #f1faee;
            --gold: #ffd166;
            --success: #06d6a0;
            --neon-pink: #ff00ff;
            --neon-blue: #00ffff;
            --fruit-theme: #ff6b6b;
            --gem-theme: #48dbfb;
            --mystery-theme: #5f27cd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), 
                        url('https://images.unsplash.com/photo-1518895949257-7621c3c786d7') center/cover no-repeat fixed;
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(29, 53, 87, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            border: 3px solid var(--gold);
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, var(--neon-pink), var(--neon-blue));
            z-index: -1;
            filter: blur(20px);
            opacity: 0.3;
            animation: glow 3s linear infinite;
        }
        
        @keyframes glow {
            0% { opacity: 0.3; }
            50% { opacity: 0.5; }
            100% { opacity: 0.3; }
        }
        
        /* Multiplayer Panel Styles */
        .multiplayer-panel {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid var(--secondary);
            box-shadow: 0 0 15px rgba(69, 123, 157, 0.5);
        }

        .multiplayer-panel h3 {
            color: var(--gold);
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 5px var(--gold);
        }

        #roomControls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }

        .multiplayer-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .multiplayer-btn:hover {
            background: var(--primary);
            transform: scale(1.05);
        }

        .join-container {
            display: flex;
            gap: 5px;
        }

        #roomCodeInput {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--gold);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            min-width: 150px;
        }

        .player-list {
            margin-top: 15px;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
        }

        .player-list h4 {
            margin-bottom: 10px;
            color: var(--gold);
        }

        .player-list ul {
            list-style: none;
            padding: 0;
        }

        .player-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
        }

        .player-list li:before {
            content: "üë§";
            margin-right: 10px;
        }

        /* Rest of your existing styles... */
        .auth-screen {
            text-align: center;
            animation: fadeIn 0.5s;
        }
        
        .auth-screen h1 {
            color: var(--gold);
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(255, 209, 102, 0.7);
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        
        .game-screen {
            display: none;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--gold);
        }
        
        h1 {
            color: var(--gold);
            font-size: 2rem;
            text-shadow: 0 0 5px var(--gold);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .player-stats {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .balance, .level-display {
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: bold;
            border: 1px solid var(--gold);
        }
        
        .xp-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .xp-progress {
            height: 100%;
            background: linear-gradient(to right, #48dbfb, #0abde3);
            width: 0%;
            transition: width 0.5s;
        }
        
        .logout-btn {
            background: var(--primary);
            color: white;
            padding: 8px 15px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .slot-machine.fruit-theme {
            background: linear-gradient(145deg, #ff6b6b, #ff8e8e);
            border: 4px solid #ff4757;
        }
        
        .slot-machine.gem-theme {
            background: linear-gradient(145deg, #48dbfb, #0abde3);
            border: 4px solid #01a3a4;
        }
        
        .slot-machine.mystery-theme {
            background: linear-gradient(145deg, #5f27cd, #341f97);
            border: 4px solid #341f97;
        }
        
        .slot-machine {
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .slot-machine::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--gold), transparent);
        }
        
        .machine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .machine-header h2 {
            font-size: 1.5rem;
        }
        
        .bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .bet-amount {
            font-weight: bold;
            background: var(--dark);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            border: 1px solid var(--gold);
        }
        
        .bet-btn {
            background: var(--secondary);
            color: white;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bet-btn:hover {
            transform: scale(1.1);
            background: var(--primary);
        }
        
        .slots {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            position: relative;
        }
        
        .slot {
            font-size: 4rem;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            border: 3px solid #555;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .slot::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
            pointer-events: none;
        }
        
        .slot-info {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.7rem;
            color: var(--gold);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .slot:hover .slot-info {
            opacity: 1;
        }
        
        .spin-btn {
            display: block;
            width: 200px;
            margin: 0 auto;
            font-size: 1.2rem;
            padding: 15px;
            background: linear-gradient(to right, var(--primary), #f4a261);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .spin-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--primary);
        }
        
        .spin-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .auto-spin-btn {
            background: var(--secondary);
            margin-top: 10px;
        }
        
        .message-box {
            background: rgba(255, 255, 255, 0.9);
            color: var(--dark);
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            display: none;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .level-up {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s;
        }
        
        .level-up-content {
            background: linear-gradient(45deg, #1d3557, #457b9d);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
            border: 3px solid var(--gold);
            box-shadow: 0 0 30px var(--gold);
        }
        
        .level-up-content h2 {
            color: var(--gold);
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--gold);
        }
        
        @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
        }
        
        .spinning {
            animation: spin 0.1s infinite linear;
        }
        
        @keyframes win {
            0% { background-color: var(--gold); }
            50% { background-color: white; }
            100% { background-color: var(--gold); }
        }
        
        .win {
            animation: win 0.5s 3;
        }
        
        @keyframes jackpot {
            0% { transform: scale(1); color: black; }
            50% { transform: scale(1.2); color: red; }
            100% { transform: scale(1); color: black; }
        }
        
        .jackpot {
            animation: jackpot 0.5s 3;
        }
        
        @media (max-width: 768px) {
            .slot {
                width: 80px;
                height: 80px;
                font-size: 3rem;
            }
            
            .player-stats {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Authentication Screen -->
        <div class="auth-screen" id="authScreen">
            <h1>üé∞ Lucky Slots Extreme üé∞</h1>
            <div class="auth-form" id="loginForm">
                <h2>Login to Play</h2>
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                <button id="loginBtn">Login</button>
                <button class="toggle-auth" id="showSignup">Don't have an account? Sign up</button>
            </div>
            
            <div class="auth-form" id="signupForm" style="display: none;">
                <h2>Create Account</h2>
                <div class="form-group">
                    <label for="signupUsername">Username</label>
                    <input type="text" id="signupUsername" placeholder="Choose a username (min 3 chars)">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="Choose a password (min 4 chars)">
                </div>
                <button id="signupBtn">Create Account</button>
                <button class="toggle-auth" id="showLogin">Already have an account? Login</button>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <header>
                <h1>Lucky Slots Extreme</h1>
                <div class="user-info">
                    <div class="player-stats">
                        <div class="balance">Balance: <span id="balance">100</span> chips</div>
                        <div class="level-display">
                            <div>Level <span id="level">1</span></div>
                            <div class="xp-bar">
                                <div class="xp-progress" id="xpBar"></div>
                            </div>
                        </div>
                    </div>
                    <button class="logout-btn" id="logoutBtn">Logout</button>
                </div>
            </header>
            
            <!-- Multiplayer Panel -->
            <div class="multiplayer-panel">
                <h3>üéÆ Multiplayer Mode üéÆ</h3>
                <div id="roomControls">
                    <button id="createRoomBtn" class="multiplayer-btn">Create Room</button>
                    <div class="join-container">
                        <input type="text" id="roomCodeInput" placeholder="Enter room code">
                        <button id="joinRoomBtn" class="multiplayer-btn">Join</button>
                    </div>
                    <button id="startGameBtn" class="multiplayer-btn" disabled>Start Game</button>
                </div>
                <div class="player-list">
                    <h4>Players (<span id="playerCount">0</span>/4):</h4>
                    <ul id="playerList"></ul>
                </div>
            </div>
            
            <!-- Jackpot Display -->
            <div class="jackpot-display" style="text-align: center; margin-bottom: 20px; font-size: 1.2rem;">
                üèÜ Progressive Jackpot: <span id="jackpot">1000</span> chips üèÜ
            </div>
            
            <!-- Slot Machines (same as before) -->
            <div class="slot-machine fruit-theme">
                <!-- ... (keep your existing slot machine HTML) ... -->
            </div>
            
            <div class="slot-machine gem-theme">
                <!-- ... (keep your existing slot machine HTML) ... -->
            </div>
            
            <div class="slot-machine mystery-theme">
                <!-- ... (keep your existing slot machine HTML) ... -->
            </div>
            
            <div class="message-box" id="messageBox"></div>
            
            <!-- Leaderboard -->
            <div class="leaderboard">
                <h3>üèÜ Top Winners üèÜ</h3>
                <ol id="leaderboardList">
                    <!-- Leaderboard entries will appear here -->
                </ol>
            </div>
        </div>
    </div>

    <!-- Bonus Round Screen (hidden by default) -->
    <div class="bonus-round" id="bonusRound" style="display: none;">
        <!-- ... (keep your existing bonus round HTML) ... -->
    </div>

    <!-- Level Up Screen (hidden by default) -->
    <div class="level-up" id="levelUpScreen" style="display: none;">
        <!-- ... (keep your existing level up HTML) ... -->
    </div>

    <!-- Sound Effects -->
    <audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-slot-machine-spin-1930.mp3"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="loseSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-game-over-213.mp3"></audio>
    <audio id="coinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-coins-handling-1939.mp3"></audio>
    <audio id="bonusSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
    <audio id="jackpotSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="levelUpSound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"></audio>

    <!-- Firebase and Confetti -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <script>
// ==================== FIREBASE CONFIGURATION ====================
const firebaseConfig = {
  apiKey: "AIzaSyCAGhW1W0Lvif6DUwZMkxMuUxW4IF51s70"
  authDomain: "lucky-slots-multiplayer.firebaseapp.com"
  projectId: "lucky-slots-multiplayer",
  storageBucket: "lucky-slots-multiplayer.firebasestorage.app"
  messagingSenderId: "862559494769"
  appId: "1:862559494769:web:a37ac6132adc3a76e071d0"
  measurementId: "G-66D5589ZPH"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

// ==================== GAME CONFIGURATION ====================
const slotConfigs = {
    low: {
        name: "Fruit Fiesta",
        theme: "fruit-theme",
        symbols: {
            'üçí': { name: 'Cherry', payout: 2, weight: 25 },
            'üçã': { name: 'Lemon', payout: 3, weight: 20 },
            'üçä': { name: 'Orange', payout: 4, weight: 15 },
            'üçá': { name: 'Grape', payout: 5, weight: 10 },
            'üçâ': { name: 'Watermelon', payout: 7, weight: 5 },
            '7Ô∏è‚É£': { name: 'Seven', payout: 10, weight: 1 }
        },
        winChance: 0.15,
        description: "Classic fruit slots - simple but rewarding!"
    },
    medium: {
        name: "Gemstone Glory",
        theme: "gem-theme",
        symbols: {
            'üíé': { name: 'Diamond', payout: 0, weight: 8, bonusTrigger: true },
            'üîÆ': { name: 'Crystal Ball', payout: 0, weight: 15, isWild: true },
            'üíç': { name: 'Ring', payout: 10, weight: 20 },
            'üî±': { name: 'Trident', payout: 7, weight: 15 },
            'üëë': { name: 'Crown', payout: 15, weight: 10 },
            'üí∞': { name: 'Money Bag', payout: 20, weight: 5 }
        },
        winChance: 0.1,
        description: "Gem slots - wild symbols and bonus triggers!"
    },
    high: {
        name: "Mystery Vault",
        theme: "mystery-theme",
        symbols: {
            'üèÜ': { name: 'Trophy', payout: 0, weight: 3, isJackpot: true },
            '‚ùì': { name: 'Mystery', payout: 0, weight: 20, isMystery: true },
            '‚ò†Ô∏è': { name: 'Skull', payout: -1, weight: 25 },
            'ü§ë': { name: 'Money Face', payout: 15, weight: 15 },
            'üí∏': { name: 'Money Wings', payout: 20, weight: 10 },
            'üí∞': { name: 'Money Bag', payout: 25, weight: 5 }
        },
        winChance: 0.075,
        description: "High risk, high reward - not for the faint of heart!"
    }
};

// ==================== GAME STATE ====================
let currentUser = null;
let users = {};
let bets = { low: 5, medium: 25, high: 100 };
let leaderboard = [];
let autoSpinInterval;
let autoSpinCount = 0;
let jackpot = 1000;
let bonusRoundActive = false;
let freeSpins = 0;
let bonusWins = 0;

// Multiplayer state
const multiplayer = {
    roomId: null,
    players: [],
    currentTurn: null,
    gameStarted: false,
    maxPlayers: 4,
    minPlayers: 2
};

// ==================== DOM ELEMENTS ====================
const authScreen = document.getElementById('authScreen');
const gameScreen = document.getElementById('gameScreen');
const loginForm = document.getElementById('loginForm');
const signupForm = document.getElementById('signupForm');
const showLogin = document.getElementById('showLogin');
const showSignup = document.getElementById('showSignup');
const loginBtn = document.getElementById('loginBtn');
const signupBtn = document.getElementById('signupBtn');
const logoutBtn = document.getElementById('logoutBtn');
const balanceDisplay = document.getElementById('balance');
const levelDisplay = document.getElementById('level');
const xpBar = document.getElementById('xpBar');
const messageBox = document.getElementById('messageBox');
const jackpotDisplay = document.getElementById('jackpot');
const bonusRound = document.getElementById('bonusRound');
const freeSpinsCount = document.getElementById('freeSpinsCount');
const spinsRemaining = document.getElementById('spinsRemaining');
const bonusWinsDisplay = document.getElementById('bonusWins');
const bonusSpinBtn = document.getElementById('bonusSpinBtn');
const levelUpScreen = document.getElementById('levelUpScreen');
const newLevelDisplay = document.getElementById('newLevel');
const levelUpBtn = document.getElementById('levelUpBtn');
const createRoomBtn = document.getElementById('createRoomBtn');
const joinRoomBtn = document.getElementById('joinRoomBtn');
const roomCodeInput = document.getElementById('roomCodeInput');
const startGameBtn = document.getElementById('startGameBtn');
const playerList = document.getElementById('playerList');
const playerCount = document.getElementById('playerCount');

// Sound elements
const spinSound = document.getElementById('spinSound');
const winSound = document.getElementById('winSound');
const loseSound = document.getElementById('loseSound');
const coinSound = document.getElementById('coinSound');
const bonusSound = document.getElementById('bonusSound');
const jackpotSound = document.getElementById('jackpotSound');
const levelUpSound = document.getElementById('levelUpSound');

// ==================== AUTHENTICATION FUNCTIONS ====================
async function login(username, password) {
    try {
        const userCredential = await auth.signInWithEmailAndPassword(`${username}@luckyslots.com`, password);
        currentUser = username;
        authScreen.style.display = 'none';
        gameScreen.style.display = 'block';
        await loadData();
        showMessage(`üéâ Welcome back, ${username}!`);
        return true;
    } catch (error) {
        if (error.code === 'auth/user-not-found') {
            return await signup(username, password);
        }
        showMessage("Login failed: " + error.message, true);
        return false;
    }
}

async function signup(username, password) {
    try {
        const userCredential = await auth.createUserWithEmailAndPassword(`${username}@luckyslots.com`, password);
        
        await db.collection('users').doc(username).set({
            balance: 1000,
            level: 1,
            xp: 0,
            xpToNextLevel: 100,
            wins: 0,
            spins: 0,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        currentUser = username;
        authScreen.style.display = 'none';
        gameScreen.style.display = 'block';
        await loadData();
        showMessage(`‚ú® Account created, ${username}! Start with 1000 chips.`);
        return true;
    } catch (error) {
        showMessage("Signup failed: " + error.message, true);
        return false;
    }
}

function logout() {
    auth.signOut().then(() => {
        currentUser = null;
        gameScreen.style.display = 'none';
        authScreen.style.display = 'block';
        document.getElementById('loginUsername').value = '';
        document.getElementById('loginPassword').value = '';
        localStorage.removeItem('lastRoom');
    });
}

// ==================== MULTIPLAYER FUNCTIONS ====================
async function createRoom() {
    try {
        const roomRef = await db.collection('rooms').add({
            creator: currentUser,
            players: [currentUser],
            gameStarted: false,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            currentTurn: null,
            jackpot: 1000
        });
        
        multiplayer.roomId = roomRef.id;
        localStorage.setItem('lastRoom', multiplayer.roomId);
        listenToRoomChanges();
        showMessage(`üéâ Room created! Share this code: ${multiplayer.roomId}`);
        createRoomBtn.disabled = true;
        joinRoomBtn.disabled = true;
    } catch (error) {
        showMessage("Error creating room: " + error.message, true);
    }
}

async function joinRoom(roomId) {
    try {
        const roomRef = db.collection('rooms').doc(roomId);
        const room = await roomRef.get();
        
        if (!room.exists) {
            showMessage("Room not found", true);
            return;
        }
        
        const roomData = room.data();
        
        if (roomData.players.length >= multiplayer.maxPlayers) {
            showMessage("Room is full", true);
            return;
        }
        
        if (roomData.gameStarted) {
            showMessage("Game already started", true);
            return;
        }
        
        await roomRef.update({
            players: firebase.firestore.FieldValue.arrayUnion(currentUser)
        });
        
        multiplayer.roomId = roomId;
        localStorage.setItem('lastRoom', multiplayer.roomId);
        listenToRoomChanges();
        showMessage(`üéÆ Joined room ${roomId}`);
        createRoomBtn.disabled = true;
        joinRoomBtn.disabled = true;
    } catch (error) {
        showMessage("Error joining room: " + error.message, true);
    }
}

function listenToRoomChanges() {
    db.collection('rooms').doc(multiplayer.roomId).onSnapshot((doc) => {
        const data = doc.data();
        if (!data) return;
        
        multiplayer.players = data.players;
        multiplayer.gameStarted = data.gameStarted;
        multiplayer.currentTurn = data.currentTurn;
        jackpot = data.jackpot || 1000;
        jackpotDisplay.textContent = jackpot;
        
        updatePlayerList();
        
        if (multiplayer.players.length >= multiplayer.minPlayers) {
            startGameBtn.disabled = false;
        } else {
            startGameBtn.disabled = true;
        }
        
        if (multiplayer.gameStarted) {
            if (data.currentTurn === currentUser) {
                showMessage("üé≤ It's your turn to spin!");
                enableGameControls(true);
            } else {
                showMessage(`‚è≥ Waiting for ${data.currentTurn} to spin...`);
                enableGameControls(false);
            }
        }
    });
}

async function startGame() {
    try {
        if (multiplayer.players.length < multiplayer.minPlayers) {
            showMessage(`Need at least ${multiplayer.minPlayers} players`, true);
            return;
        }
        
        await db.collection('rooms').doc(multiplayer.roomId).update({
            gameStarted: true,
            currentTurn: multiplayer.players[Math.floor(Math.random() * multiplayer.players.length)]
        });
        
        startGameBtn.disabled = true;
        showMessage("Game started! First turn: " + multiplayer.currentTurn);
    } catch (error) {
        showMessage("Error starting game: " + error.message, true);
    }
}

async function endTurn() {
    try {
        const currentIdx = multiplayer.players.indexOf(multiplayer.currentTurn);
        const nextIdx = (currentIdx + 1) % multiplayer.players.length;
        const nextPlayer = multiplayer.players[nextIdx];
        
        await db.collection('rooms').doc(multiplayer.roomId).update({
            currentTurn: nextPlayer
        });
    } catch (error) {
        showMessage("Error passing turn: " + error.message, true);
    }
}

function updatePlayerList() {
    playerList.innerHTML = '';
    playerCount.textContent = multiplayer.players.length;
    
    multiplayer.players.forEach(player => {
        const li = document.createElement('li');
        li.textContent = player;
        if (player === currentUser) {
            li.style.fontWeight = 'bold';
            li.style.color = 'var(--gold)';
        }
        if (multiplayer.gameStarted && player === multiplayer.currentTurn) {
            li.innerHTML += ' üé≤';
        }
        playerList.appendChild(li);
    });
}

function enableGameControls(enabled) {
    document.querySelectorAll('.spin-btn').forEach(btn => {
        btn.disabled = !enabled;
    });
}

// ==================== CORE GAME FUNCTIONS ====================
function showMessage(message, isError = false) {
    messageBox.textContent = message;
    messageBox.style.display = 'block';
    messageBox.style.backgroundColor = isError ? 'rgba(230, 57, 70, 0.9)' : 'rgba(255, 255, 255, 0.9)';
    
    setTimeout(() => {
        messageBox.style.display = 'none';
    }, 3000);
}

function playSound(sound) {
    sound.currentTime = 0;
    sound.play();
}

function updateBalance() {
    if (currentUser) {
        balanceDisplay.textContent = users[currentUser].balance;
        db.collection('users').doc(currentUser).update({
            balance: users[currentUser].balance
        });
    }
}

function updateLevelDisplay() {
    if (currentUser) {
        const user = users[currentUser];
        levelDisplay.textContent = user.level;
        xpBar.style.width = `${(user.xp / user.xpToNextLevel) * 100}%`;
        db.collection('users').doc(currentUser).update({
            level: user.level,
            xp: user.xp,
            xpToNextLevel: user.xpToNextLevel
        });
    }
}

function addXP(amount) {
    const user = users[currentUser];
    user.xp += amount;
    
    if (user.xp >= user.xpToNextLevel) {
        user.level++;
        user.xp = user.xp - user.xpToNextLevel;
        user.xpToNextLevel = Math.floor(user.xpToNextLevel * 1.5);
        
        newLevelDisplay.textContent = user.level;
        levelUpScreen.style.display = 'flex';
        playSound(levelUpSound);
        confetti({ particleCount: 100, spread: 70 });
    }
    
    updateLevelDisplay();
}

function updateJackpot() {
    if (!multiplayer.gameStarted) {
        jackpot += Math.floor(bets.high * 0.01);
        jackpotDisplay.textContent = jackpot;
    }
}

function updateLeaderboard(winnerName, winAmount) {
    leaderboard.push({ name: winnerName, score: winAmount });
    leaderboard.sort((a, b) => b.score - a.score);
    leaderboard = leaderboard.slice(0, 5);
    displayLeaderboard();
}

function displayLeaderboard() {
    const leaderboardList = document.getElementById('leaderboardList');
    leaderboardList.innerHTML = '';
    
    leaderboard.forEach((player, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
            <span>${index + 1}. ${player.name}</span>
            <span>${player.score} chips</span>
        `;
        leaderboardList.appendChild(li);
    });
}

function getWeightedRandomSymbol(level, exclude = null) {
    const config = slotConfigs[level];
    let symbolPool = [];
    
    for (const symbol in config.symbols) {
        if (!exclude || symbol !== exclude) {
            const weight = config.symbols[symbol].weight;
            for (let i = 0; i < weight; i++) {
                symbolPool.push(symbol);
            }
        }
    }
    
    return symbolPool[Math.floor(Math.random() * symbolPool.length)];
}

async function spin(level) {
    if (!currentUser || bonusRoundActive) return false;
    if (multiplayer.gameStarted && multiplayer.currentTurn !== currentUser) {
        showMessage("‚è≥ Wait for your turn!", true);
        return false;
    }
    
    const bet = bets[level];
    const user = users[currentUser];
    const config = slotConfigs[level];
    
    if (user.balance < bet) {
        showMessage("Not enough chips to bet!", true);
        playSound(loseSound);
        return false;
    }
    
    // Deduct bet
    user.balance -= bet;
    user.spins++;
    updateBalance();
    updateJackpot();
    playSound(coinSound);
    
    // Get slot elements
    const slots = [
        document.getElementById(`${level}1`),
        document.getElementById(`${level}2`),
        document.getElementById(`${level}3`)
    ];
    
    // Disable buttons during spin
    document.getElementById(`spin${level.charAt(0).toUpperCase() + level.slice(1)}`).disabled = true;
    document.getElementById(`autoSpin${level.charAt(0).toUpperCase() + level.slice(1)}`).disabled = true;
    
    // Play spin sound
    playSound(spinSound);
    
    // Add spinning animation
    slots.forEach(slot => slot.classList.add('spinning'));
    
    // Spin animation
    let spins = 0;
    const spinInterval = setInterval(() => {
        slots.forEach(slot => {
            const randomSymbol = getWeightedRandomSymbol(level);
            slot.textContent = randomSymbol;
        });
        
        spins++;
        if (spins >= 20) {
            clearInterval(spinInterval);
            
            // Remove spinning animation
            slots.forEach(slot => slot.classList.remove('spinning'));
            
            // Final result with adjusted odds
            const results = [];
            let forceWin = false;
            let forceBonus = false;
            let forceJackpot = false;
            
            // Check if we should force a win (based on winChance)
            if (Math.random() < config.winChance) {
                forceWin = true;
                
                // Small chance to force bonus or jackpot
                if (level === 'medium' && Math.random() < 0.05) {
                    forceBonus = true;
                } else if (level === 'high' && Math.random() < 0.02) {
                    forceJackpot = true;
                }
            }
            
            if (forceJackpot) {
                // Force jackpot win
                results[0] = 'üèÜ';
                results[1] = 'üèÜ';
                results[2] = 'üèÜ';
            } else if (forceBonus && level === 'medium') {
                // Force bonus trigger
                results[0] = 'üíé';
                results[1] = 'üíé';
                results[2] = 'üíé';
            } else if (forceWin) {
                // Force a regular win
                const winningSymbols = Object.keys(config.symbols).filter(sym => 
                    config.symbols[sym].payout > 0 && !config.symbols[sym].isWild
                );
                
                if (winningSymbols.length > 0) {
                    const symbol = winningSymbols[Math.floor(Math.random() * winningSymbols.length)];
                    
                    // 60% chance of full match, 40% chance of partial match
                    if (Math.random() < 0.6) {
                        // Full match
                        results[0] = symbol;
                        results[1] = symbol;
                        results[2] = symbol;
                    } else {
                        // Partial match (two of the same)
                        results[0] = symbol;
                        results[1] = symbol;
                        results[2] = getWeightedRandomSymbol(level, symbol); // Ensure third is different
                    }
                } else {
                    // No winning symbols available (shouldn't happen)
                    results[0] = getWeightedRandomSymbol(level);
                    results[1] = getWeightedRandomSymbol(level);
                    results[2] = getWeightedRandomSymbol(level);
                }
            } else {
                // Regular random results
                results[0] = getWeightedRandomSymbol(level);
                results[1] = getWeightedRandomSymbol(level);
                results[2] = getWeightedRandomSymbol(level);
            }
            
            // Apply wild symbols (only for gem theme)
            if (level === 'medium') {
                // Check for wild symbols and replace adjacent symbols
                if (results[1] === 'üîÆ') {
                    // Middle wild - replace both sides
                    results[0] = results[2];
                } else if (results[0] === 'üîÆ') {
                    // Left wild - replace with right
                    results[0] = results[1];
                } else if (results[2] === 'üîÆ') {
                    // Right wild - replace with left
                    results[2] = results[1];
                }
            }
            
            // Check for bonus trigger (diamonds)
            if (results.filter(s => s === 'üíé').length >= 3 && level === 'medium') {
                startBonusRound(5); // 5 free spins
            }
            
            slots.forEach((slot, i) => slot.textContent = results[i]);
            
            // Check for win
            checkWin(results, level);
            
            // In multiplayer, update the room's jackpot and pass turn
            if (multiplayer.gameStarted) {
                db.collection('rooms').doc(multiplayer.roomId).update({
                    jackpot: jackpot
                }).then(() => {
                    endTurn();
                });
            }
            
            // Re-enable buttons
            document.getElementById(`spin${level.charAt(0).toUpperCase() + level.slice(1)}`).disabled = false;
            document.getElementById(`autoSpin${level.charAt(0).toUpperCase() + level.slice(1)}`).disabled = false;
            
            return true;
        }
    }, 100);
}

function checkWin(results, level) {
    const resultStr = results.join('');
    const user = users[currentUser];
    const bet = bets[level];
    const config = slotConfigs[level];
    let winAmount = 0;
    
    // Check for jackpot win (3 trophies)
    if (results[0] === 'üèÜ' && results[1] === 'üèÜ' && results[2] === 'üèÜ' && level === 'high') {
        winAmount = jackpot;
        user.balance += winAmount;
        user.wins++;
        jackpot = 1000; // Reset jackpot
        jackpotDisplay.textContent = jackpot;
        updateBalance();
        updateLeaderboard(currentUser, winAmount);
        addXP(50); // Big XP for jackpot
        
        // Jackpot animation
        document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
            .forEach(slot => slot.classList.add('jackpot'));
        
        setTimeout(() => {
            document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
                .forEach(slot => slot.classList.remove('jackpot'));
        }, 1500);
        
        playSound(jackpotSound);
        showMessage(`JACKPOT!!! You won ${winAmount} chips!`, false);
        confetti({ particleCount: 200, spread: 100 });
        return;
    }
    
    // Check for skull (lose bet)
    if (level === 'high' && results.filter(s => s === '‚ò†Ô∏è').length >= 2) {
        playSound(loseSound);
        showMessage("Skulls! You lost your bet!", true);
        return;
    }
    
    // Check for mystery symbol (random multiplier)
    if (level === 'high' && results.includes('‚ùì')) {
        const mysteryCount = results.filter(s => s === '‚ùì').length;
        const multiplier = mysteryCount === 3 ? Math.floor(Math.random() * 15) + 6 : // 6-20x for 3
                          mysteryCount === 2 ? Math.floor(Math.random() * 10) + 3 : // 3-12x for 2
                          Math.floor(Math.random() * 5) + 2; // 2-6x for 1
        
        winAmount = bet * multiplier;
        user.balance += winAmount;
        user.wins++;
        updateBalance();
        addXP(10 * mysteryCount); // XP based on mystery symbols
        
        // Win animation
        document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
            .forEach(slot => {
                if (slot.textContent === '‚ùì') slot.classList.add('win');
            });
        
        setTimeout(() => {
            document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
                .forEach(slot => slot.classList.remove('win'));
        }, 1500);
        
        playSound(winSound);
        showMessage(`Mystery Multiplier! You won ${winAmount} chips (${multiplier}x)!`);
        
        if (multiplier >= 10) {
            confetti({ particleCount: 100, spread: 70 });
        }
        return;
    }
    
    // Check for exact matches first (highest payout)
    if (results[0] === results[1] && results[1] === results[2]) {
        const symbol = config.symbols[results[0]];
        if (symbol.payout > 0) {
            winAmount = bet * symbol.payout;
            user.balance += winAmount;
            user.wins++;
            updateBalance();
            addXP(10); // Base XP for any win
            
            // Add to leaderboard for significant wins
            if (winAmount >= 100) {
                updateLeaderboard(currentUser, winAmount);
            }
            
            // Win animation
            document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
                .forEach(slot => {
                    slot.classList.add('win');
                    if (symbol.payout >= 5) slot.classList.add('jackpot');
                });
            
            setTimeout(() => {
                document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
                    .forEach(slot => {
                        slot.classList.remove('win');
                        slot.classList.remove('jackpot');
                    });
            }, 1500);
            
            playSound(winSound);
            showMessage(`${symbol.name} WIN! You won ${winAmount} chips! ${resultStr} pays ${symbol.payout}x!`);
            
            // Small chance of confetti for big wins
            if (winAmount >= bet * 10) {
                confetti({ particleCount: 100, spread: 70 });
            }
        }
    } 
    // Check for two matching symbols (only in fruit and gem themes)
    else if (level !== 'high' && (results[0] === results[1] || results[1] === results[2] || results[0] === results[2])) {
        const matchedSymbol = results[0] === results[1] ? results[0] : results[2];
        const symbol = config.symbols[matchedSymbol];
        
        if (symbol.payout > 0) {
            winAmount = Math.floor(bet * symbol.payout * 0.5); // Half payout for two matches
            user.balance += winAmount;
            user.wins++;
            updateBalance();
            addXP(5); // Half XP for partial wins
            
            // Win animation for partial win
            if (results[0] === results[1]) {
                document.querySelectorAll(`#${level}1, #${level}2`).forEach(slot => slot.classList.add('win'));
            } else if (results[1] === results[2]) {
                document.querySelectorAll(`#${level}2, #${level}3`).forEach(slot => slot.classList.add('win'));
            } else {
                document.querySelectorAll(`#${level}1, #${level}3`).forEach(slot => slot.classList.add('win'));
            }
            
            setTimeout(() => {
                document.querySelectorAll(`#${level}1, #${level}2, #${level}3`)
                    .forEach(slot => slot.classList.remove('win'));
            }, 1500);
            
            playSound(winSound);
            showMessage(`Partial ${symbol.name} win! You won ${winAmount} chips!`);
        } else {
            playSound(loseSound);
            showMessage("No win this time. Try again!");
        }
    }
    else {
        playSound(loseSound);
        showMessage("No win this time. Try again!");
    }
}

// ==================== BONUS ROUND FUNCTIONS ====================
function startBonusRound(spins) {
    bonusRoundActive = true;
    freeSpins = spins;
    bonusWins = 0;
    freeSpinsCount.textContent = spins;
    spinsRemaining.textContent = spins;
    bonusWinsDisplay.textContent = '0';
    bonusRound.style.display = 'flex';
    playSound(bonusSound);
}

function endBonusRound() {
    bonusRoundActive = false;
    bonusRound.style.display = 'none';
    users[currentUser].balance += bonusWins;
    updateBalance();
    addXP(20); // Bonus XP for completing bonus round
    showMessage(`Bonus round complete! You won ${bonusWins} chips!`);
}

function spinBonus() {
    if (freeSpins <= 0) {
        endBonusRound();
        return;
    }
    
    const slots = [
        document.getElementById('bonusSlot1'),
        document.getElementById('bonusSlot2'),
        document.getElementById('bonusSlot3')
    ];
    
    // Disable button during spin
    bonusSpinBtn.disabled = true;
    
    // Play spin sound
    playSound(spinSound);
    
    // Add spinning animation
    slots.forEach(slot => slot.classList.add('spinning'));
    
    // Spin animation
    let spins = 0;
    const spinInterval = setInterval(() => {
        slots.forEach(slot => {
            slot.textContent = getWeightedRandomSymbol('medium');
        });
        
        spins++;
        if (spins >= 15) {
            clearInterval(spinInterval);
            
            // Remove spinning animation
            slots.forEach(slot => slot.classList.remove('spinning'));
            
            // Final result
            const results = [
                getWeightedRandomSymbol('medium'),
                getWeightedRandomSymbol('medium'),
                getWeightedRandomSymbol('medium')
            ];
            
            slots.forEach((slot, i) => slot.textContent = results[i]);
            
            // Check for win (3x multiplier in bonus)
            if (results[0] === results[1] && results[1] === results[2]) {
                const symbol = slotConfigs.medium.symbols[results[0]];
                if (symbol.payout > 0) {
                    const winAmount = bets.medium * symbol.payout * 3; // 3x multiplier
                    bonusWins += winAmount;
                    bonusWinsDisplay.textContent = bonusWins;
                    
                    // Win animation
                    slots.forEach(slot => slot.classList.add('win'));
                    setTimeout(() => {
                        slots.forEach(slot => slot.classList.remove('win'));
                    }, 1000);
                    
                    playSound(winSound);
                }
            }
            
            freeSpins--;
            spinsRemaining.textContent = freeSpins;
            
            // Re-enable button
            bonusSpinBtn.disabled = false;
            
            // Auto-end if no more spins
            if (freeSpins <= 0) {
                setTimeout(endBonusRound, 1500);
            }
        }
    }, 100);
}

// ==================== AUTO SPIN FUNCTIONS ====================
function autoSpin(level) {
    if (autoSpinInterval || bonusRoundActive) {
        stopAutoSpin();
        return;
    }
    
    autoSpinCount = 5;
    document.getElementById(`autoSpin${level.charAt(0).toUpperCase() + level.slice(1)}`).textContent = "STOP AUTO SPIN";
    
    autoSpinInterval = setInterval(() => {
        if (autoSpinCount > 0 && users[currentUser].balance >= bets[level]) {
            const didSpin = spin(level);
            if (didSpin) autoSpinCount--;
        } else {
            stopAutoSpin();
        }
    }, 1500);
}

function stopAutoSpin() {
    clearInterval(autoSpinInterval);
    autoSpinInterval = null;
    document.querySelectorAll('.auto-spin-btn').forEach(btn => {
        btn.textContent = "AUTO SPIN (5x)";
    });
}

// ==================== INITIALIZATION ====================
async function loadData() {
    if (currentUser) {
        const userDoc = await db.collection('users').doc(currentUser).get();
        if (userDoc.exists) {
            users[currentUser] = userDoc.data();
            balanceDisplay.textContent = users[currentUser].balance;
            levelDisplay.textContent = users[currentUser].level;
            xpBar.style.width = `${(users[currentUser].xp / users[currentUser].xpToNextLevel) * 100}%`;
        }
        
        // Load leaderboard
        const leaderboardSnapshot = await db.collection('leaderboard')
            .orderBy('score', 'desc')
            .limit(5)
            .get();
        
        leaderboard = leaderboardSnapshot.docs.map(doc => doc.data());
        displayLeaderboard();
    }
}

auth.onAuthStateChanged(async (user) => {
    if (user) {
        // User is signed in
        currentUser = user.email.split('@')[0];
        authScreen.style.display = 'none';
        gameScreen.style.display = 'block';
        await loadData();
        
        // Check if we were in a room before refresh
        const lastRoom = localStorage.getItem('lastRoom');
        if (lastRoom) {
            roomCodeInput.value = lastRoom;
            joinRoom(lastRoom);
        }
    } else {
        // User is signed out
        currentUser = null;
        gameScreen.style.display = 'none';
        authScreen.style.display = 'block';
    }
});

// ==================== EVENT LISTENERS ====================
// Login/Signup form toggles
showLogin.addEventListener('click', () => {
    loginForm.style.display = 'block';
    signupForm.style.display = 'none';
});

showSignup.addEventListener('click', () => {
    signupForm.style.display = 'block';
    loginForm.style.display = 'none';
});

// Login button
loginBtn.addEventListener('click', async () => {
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;
    
    if (!username || username.length < 3) {
        showMessage("Username must be at least 3 characters", true);
        return;
    }
    
    if (!password || password.length < 4) {
        showMessage("Password must be at least 4 characters", true);
        return;
    }
    
    await login(username, password);
});

// Signup button
signupBtn.addEventListener('click', async () => {
    const username = document.getElementById('signupUsername').value.trim();
    const password = document.getElementById('signupPassword').value;
    
    if (!username || username.length < 3) {
        showMessage("Username must be at least 3 characters", true);
        return;
    }
    
    if (!password || password.length < 4) {
        showMessage("Password must be at least 4 characters", true);
        return;
    }
    
    await signup(username, password);
});

logoutBtn.addEventListener('click', logout);

// Multiplayer controls
createRoomBtn.addEventListener('click', createRoom);
joinRoomBtn.addEventListener('click', () => {
    const roomCode = roomCodeInput.value.trim();
    if (roomCode) joinRoom(roomCode);
});
startGameBtn.addEventListener('click', startGame);

// Spin buttons
document.getElementById('spinLow').addEventListener('click', () => spin('low'));
document.getElementById('spinMedium').addEventListener('click', () => spin('medium'));
document.getElementById('spinHigh').addEventListener('click', () => spin('high'));

// Auto-spin buttons
document.getElementById('autoSpinLow').addEventListener('click', () => autoSpin('low'));
document.getElementById('autoSpinMedium').addEventListener('click', () => autoSpin('medium'));
document.getElementById('autoSpinHigh').addEventListener('click', () => autoSpin('high'));

// Bonus spin button
bonusSpinBtn.addEventListener('click', spinBonus);

// Level up button
levelUpBtn.addEventListener('click', () => {
    levelUpScreen.style.display = 'none';
});

// Bet adjustment buttons
document.getElementById('lowBetUp').addEventListener('click', () => adjustBet('low', 'up'));
document.getElementById('lowBetDown').addEventListener('click', () => adjustBet('low', 'down'));
document.getElementById('mediumBetUp').addEventListener('click', () => adjustBet('medium', 'up'));
document.getElementById('mediumBetDown').addEventListener('click', () => adjustBet('medium', 'down'));
document.getElementById('highBetUp').addEventListener('click', () => adjustBet('high', 'up'));
document.getElementById('highBetDown').addEventListener('click', () => adjustBet('high', 'down'));

function adjustBet(level, direction) {
    const range = {
        low: { min: 1, max: 10, step: 1 },
        medium: { min: 10, max: 50, step: 5 },
        high: { min: 50, max: 250, step: 25 }
    }[level];
    
    let newBet = bets[level] + (direction === 'up' ? range.step : -range.step);
    newBet = Math.max(range.min, Math.min(range.max, newBet));
    bets[level] = newBet;
    document.getElementById(`${level}Bet`).textContent = bets[level];
    playSound(coinSound);
}

// Enter key submission
document.getElementById('loginUsername').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') loginBtn.click();
});

document.getElementById('loginPassword').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') loginBtn.click();
});

document.getElementById('signupUsername').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') signupBtn.click();
});

document.getElementById('signupPassword').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') signupBtn.click();
});

// Initialize
loadData();
    </script>
</body>
</html>
